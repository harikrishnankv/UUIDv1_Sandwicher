<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UUID SANDWICHER</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">
    <div class="container-fluid" style="flex: 1;">
        <!-- Header -->
        <header class="bg-primary text-white py-4 mb-4">
            <div class="container">
                <h1 class="display-4 text-center">
                    <img id="brand-logo-img" class="brand-logo-img me-3" 
                         src="{{ url_for('static', filename='images/burger-wizard.svg') }}" 
                         alt="UUID SANDWICHER Logo" 
                         style="height: 96px; width: auto; display: inline-block !important; visibility: visible !important; opacity: 1 !important; vertical-align: middle;"
                         onload="console.log('Image loaded successfully');"
                         onerror="console.error('Image failed to load:', this.src); this.style.display='none'; if(document.getElementById('brand-fa')) document.getElementById('brand-fa').style.display='inline-block';">
                    <span id="brand-fa" class="fa-stack me-3 brand-stack" style="vertical-align: middle; line-height: 1; display: none;">
                        <i class="fas fa-hamburger fa-stack-2x brand-icon-burger"></i>
                        <i class="fas fa-hat-wizard fa-stack-1x brand-icon-hat"></i>
                    </span>
                    UUID SANDWICHER
                </h1>
                <p class="lead text-center">A Comprehensive Tool For UUID Analysis And For Sandwich Attack Payload Generation</p>
            </div>
        </header>

        <div class="container">
            <!-- Navigation Tabs -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <ul class="nav nav-tabs" id="mainTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="single-tab" data-bs-toggle="tab" data-bs-target="#single" type="button" role="tab">
                            <i class="fas fa-plus-circle me-2"></i>Single UUID
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="analyze-tab" data-bs-toggle="tab" data-bs-target="#analyze" type="button" role="tab">
                            <i class="fas fa-search me-2"></i>Analyze UUID
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="range-tab" data-bs-toggle="tab" data-bs-target="#range" type="button" role="tab">
                            <i class="fas fa-skull me-2 text-danger"></i>Sandwich Payload Generator
                        </button>
                    </li>
                </ul>
                <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#creditsModal">
                    <i class="fas fa-info-circle me-2"></i>Credits
                </button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content" id="mainTabsContent">
                <!-- Single UUID Generation -->
                <div class="tab-pane fade show active" id="single" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-plus-circle me-2"></i>Generate Single UUID</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="uuidVersionSelect" class="form-label">UUID Version:</label>
                                        <select class="form-select" id="uuidVersionSelect">
                                            <option value="1">Version 1 - Time-based (MAC address + timestamp)</option>
                                            <option value="2">Version 2 - DCE Security (time-based + POSIX UID/GID)</option>
                                            <option value="3">Version 3 - Name-based using MD5 hash</option>
                                            <option value="4">Version 4 - Random (cryptographically secure)</option>
                                        </select>
                                        <small class="form-text text-muted">
                                            <strong>v1:</strong> Time-based with MAC address<br>
                                            <strong>v2:</strong> DCE Security (time-based + POSIX UID/GID)<br>
                                            <strong>v3:</strong> Name-based using MD5 hash of namespace + name<br>
                                            <strong>v4:</strong> Random (cryptographically secure)
                                        </small>
                                    </div>
                                    <div class="mb-3" id="nameInputContainer" style="display: none;">
                                        <label for="namespaceSelect" class="form-label">Namespace for UUID v3:</label>
                                        <select class="form-select mb-2" id="namespaceSelect">
                                            <option value="DNS">DNS - Domain Name System (for domain names)</option>
                                            <option value="URL">URL - Uniform Resource Locator (for URLs)</option>
                                            <option value="OID">OID - ISO Object Identifier (for ISO OIDs)</option>
                                            <option value="X500">X500 - X.500 Distinguished Name (for X.500 DNs)</option>
                                        </select>
                                        <label for="nameInput" class="form-label">Name for UUID v3:</label>
                                        <input type="text" class="form-control" id="nameInput" placeholder="Enter name for MD5 hash generation" pattern="[^<>\"']*" maxlength="1000" required>
                                        <small class="form-text text-muted">
                                            The UUID will be generated using MD5 hash of the selected namespace UUID + your name. Text only, 1-1000 characters.
                                        </small>
                                    </div>
                                    <button id="generateSingleBtn" class="btn btn-primary btn-lg w-100">
                                        <i class="fas fa-magic me-2"></i>Generate UUID
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div id="singleResult" class="mt-3" style="display: none;">
                                        <div class="alert alert-success">
                                            <h6>Generated UUID:</h6>
                                            <code id="singleUuid" class="fs-5"></code>
                                            <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyToClipboard(document.getElementById('singleUuid').textContent)">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UUID Range Generation -->
                <div class="tab-pane fade" id="range" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-skull me-2 text-danger"></i>Sandwich Payload Generator</h5>
                        </div>
                        <div class="card-body">
                            <form id="rangeForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="startUuid" class="form-label">Start UUID:</label>
                                            <input type="text" class="form-control" id="startUuid" placeholder="Enter start UUID v1" 
                                                   pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}" 
                                                   title="UUID format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="endUuid" class="form-label">End UUID:</label>
                                            <input type="text" class="form-control" id="endUuid" placeholder="Enter end UUID v1" 
                                                   pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}" 
                                                   title="UUID format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="mb-3">
                                            <div class="alert alert-info">
                                                <i class="fas fa-info-circle me-2"></i>
                                                <strong>Automatic Generation:</strong> The system will automatically generate ALL possible UUIDs between the start and end UUIDs with 100-nanosecond precision. No manual configuration needed.
                                            </div>
                                            <div class="alert alert-warning" id="largeRangeWarning" style="display: none;">
                                                <i class="fas fa-skull me-2 text-danger"></i>
                                                <strong>Large Range Warning:</strong> This range contains a very large number of UUIDs and may take a very long time to generate. Consider using a smaller range for testing.
                                            </div>
                                            <div class="alert alert-secondary">
                                                <i class="fas fa-lightbulb me-2"></i>
                                                <strong>Testing Tips:</strong> For testing, try smaller ranges like 1-6 seconds difference for a feasible output.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="mb-3">
                                            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                                <button type="button" id="estimateBtn" class="btn btn-info btn-lg me-2">
                                                    <i class="fas fa-calculator me-2"></i>Estimate Range
                                                </button>
                                                <button type="button" id="generateRangeFastBtn" class="btn btn-success btn-lg">
                                                    <i class="fas fa-download me-2"></i>Generate & Download File
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>

                            <!-- Estimation Results -->
                            <div id="estimationResults" class="mt-3" style="display: none;">
                                <div class="alert alert-info">
                                    <h6><i class="fas fa-info-circle me-2"></i>Range Estimation</h6>
                                    <div id="estimationDetails"></div>
                                </div>
                            </div>

                            <!-- Progress Bar -->
                            <div id="progressContainer" class="mt-3" style="display: none;">
                                <div class="alert alert-primary">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>Background Generation:</strong> Generating ALL UUIDs in range using optimized fast method. This runs in the background - you can continue using the app.
                                </div>
                                <div class="progress mb-2">
                                    <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                                <div id="progressText" class="text-center text-muted"></div>
                                <div class="text-center mt-3">
                                    <button id="cancelGenerationBtn" class="btn btn-danger" onclick="window.uuidApp.cancelGeneration()">
                                        <i class="fas fa-stop me-2"></i>Cancel Generation
                                    </button>
                                </div>
                            </div>

                            <!-- Results -->
                            <div id="rangeResults" class="mt-3" style="display: none;">
                                <div class="alert alert-success">
                                    <h6><i class="fas fa-check-circle me-2"></i>Generation Complete</h6>
                                    <div id="rangeSummary"></div>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <tbody id="rangeTableBody">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UUID Analysis -->
                <div class="tab-pane fade" id="analyze" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-search me-2"></i>Analyze UUID</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="analyzeUuid" class="form-label">UUID to Analyze:</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="analyzeUuid" placeholder="Enter any UUID to analyze" 
                                                   pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}" 
                                                   title="UUID format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                                            <button class="btn btn-primary" id="analyzeBtn">
                                                <i class="fas fa-search me-1"></i>Analyze
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="analysisResults" class="mt-3" style="display: none;">
                                <div class="alert alert-info">
                                    <h6><i class="fas fa-info-circle me-2"></i>UUID Analysis</h6>
                                    <div id="analysisDetails"></div>
                                </div>
                                
                                <!-- Version-specific Analysis -->
                                <div id="versionAnalysis" class="mt-3" style="display: none;">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-code-branch me-2"></i>Version-Specific Details</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="versionDetails"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="spinner-border text-primary mb-3" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h5 id="loadingTitle">Processing...</h5>
                    <p id="loadingMessage">Please wait while we process your request.</p>
                    <div class="progress mt-3">
                        <div id="modalProgressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-secondary mt-3" onclick="hideLoadingModal()">
                        <i class="fas fa-times me-1"></i>Close Modal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Warning Modal for Time Delays -->
    <div class="modal fade" id="warningModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title">
                        <i class="fas fa-exclamation-triangle me-2"></i>High Time Delay Warning
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <h6><i class="fas fa-skull me-2"></i>Attack Payload Risk Assessment</h6>
                        <p class="mb-2">The selected time range has a <strong id="warningTimeDelay">N/A</strong> second delay between first and last UUIDs.</p>
                        <p class="mb-2">This will generate approximately <strong id="warningUuidCount">N/A</strong> UUIDs.</p>
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle me-2"></i>
                            <strong>Warning:</strong> Higher time delays may cause server crashes or timeouts. For optimal sandwich attack payloads, use ranges with 1-3 seconds difference.
                        </div>
                        <p class="mb-0"><strong>Recommendation:</strong> Consider using a smaller time range for better attack effectiveness.</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>Cancel
                    </button>
                    <button type="button" class="btn btn-warning" id="acceptRiskBtn">
                        <i class="fas fa-exclamation-triangle me-1"></i>Accept Risk & Continue
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Credits/About Modal -->
    <div class="modal fade" id="creditsModal" tabindex="-1" aria-labelledby="creditsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="creditsModalLabel">
                        <i class="fas fa-star me-2"></i>Credits & About
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <h6 class="text-primary mb-3"><i class="fas fa-users me-2"></i>Credits</h6>
                        <div class="ps-3">
                            <p class="mb-2">
                                <strong>Sruthi M</strong>
                                <a href="https://in.linkedin.com/in/sruthi-m-48600866" target="_blank" rel="noopener noreferrer" class="ms-2 text-primary" title="LinkedIn Profile">
                                    <i class="fab fa-linkedin"></i>
                                </a>
                            </p>
                            <p class="mb-2">
                                <strong>Ashiq Khader</strong>
                                <a href="https://in.linkedin.com/in/ashiq-k-9308a328" target="_blank" rel="noopener noreferrer" class="ms-2 text-primary" title="LinkedIn Profile">
                                    <i class="fab fa-linkedin"></i>
                                </a>
                            </p>
                            <p class="mb-0">
                                <strong>Harikrishnan Kunnummal Veettil</strong>
                                <a href="https://in.linkedin.com/in/harikrishnan-kv-85738914a" target="_blank" rel="noopener noreferrer" class="ms-2 text-primary" title="LinkedIn Profile">
                                    <i class="fab fa-linkedin"></i>
                                </a>
                            </p>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="mb-4">
                        <h6 class="text-primary mb-3"><i class="fas fa-info-circle me-2"></i>About</h6>
                        <div class="ps-3">
                            <p class="mb-2"><strong>Version:</strong> <span class="badge bg-primary">1.0.0</span></p>
                            <p class="mb-2"><strong>Description:</strong> A comprehensive tool for UUID analysis and sandwich attack payload generation.</p>
                            <p class="mb-0"><strong>Built with:</strong> Python, Flask, and Bootstrap</p>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="text-center">
                        <small class="text-muted">&copy; 2025-26 UUID SANDWICHER</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        // Debug image loading
        window.addEventListener('DOMContentLoaded', function() {
            const img = document.getElementById('brand-logo-img');
            if (img) {
                console.log('Image element found:', img);
                console.log('Image src:', img.src);
                console.log('Image complete:', img.complete);
                console.log('Image naturalWidth:', img.naturalWidth);
                console.log('Image naturalHeight:', img.naturalHeight);
                
                img.addEventListener('load', function() {
                    console.log('Image loaded successfully!');
                });
                
                img.addEventListener('error', function(e) {
                    console.error('Image failed to load:', e);
                });
            } else {
                console.error('Image element not found!');
            }
        });
    </script>
</body>
</html> 